import pandas as pd
import numpy as np
import matplotlib.pylab as plt
# %matplotlib inline
from matplotlib.pylab import rcParams
rcParams['figure.figsize'] = 15, 6
import quandl
from time import gmtime, strftime

feedType = "SF0"

symbolList = ["AMPE","AMPH","AMRC","AMRI","AMRS","AMS","AMSG","AMT","AMTD","AMZN","AN","ANET","ANF","ANGI","ANGO","ANIK","ANSS","ANTM","AON","AOS","AP","APA","APAM","APC","APD","APEI","APH","APLE","APLP","APO","APOL","APPS","APRI","AQXP","ARAY","ARCC","ARCX","ARE","ARES","ARG","ARGS","ARIA","ARII","ARIS","ARLP","ARNC","AROC","AROPQ","ARQL","ARR","ARTNA","ARTW","ARTX","ARW","ASB","ASEI","ASGN","ASH","ASMB","ASNA","ASTC","ASYS","ATEN","ATHX","ATI","ATLO","ATML","ATO","ATR","ATRA","ATRC","ATRS","ATVI","ATW","AVA","AVAV","AVB","AVGO","AVP","AVT","AVY","AWH","AWI","AWK","AWR","AWRE","AXAS","AXGN","AXN","AXP","AXS","AXTA","AYI","AZO","BA","BAC","BAH","BASI","BAX","BBBY","BBEPQ","BBG","BBGI","BBOX","BBT","BBW","BBY","BC","BCBP","BCC","BCO","BCOV","BCR","BDC","BDMS","BDN","BDX","BEAV","BEL","BEN","BFB","BFS","BG","BGC","BGFV","BHI","BHLB","BID","BIG","BIIB","BIO","BIOA","BIOD","BIOL","BK","BKCC","BKD","BKEP","BKH","BKMU","BKS","BLK","BLL","BLUE","BMCH","BMR","BMS","BMY","BOBE","BOCH","BOH","BOKF","BOOM","BOOT","BPFH","BPOP","BR","BRC","BRCD","BRCM","BRKB","BRKR","BRO","BRSS","BRT","BSX","BTN","BTUUQ","BURL","BV","BWA","BWEN","BWLA","BWXT","BXP","BXS","BYD","C","CA","CAAS","CAB","CAG","CAH","CAKE","CAM","CAMB","CAMP","CAPN","CAR","CASC","CASS","CASY","CAT","CATM","CATY","CB","CB1","CBAN","CBG","CBI","CBK","CBL","CBM","CBOE","CBPX","CBR","CBS","CBSH","CBT","CBU","CCBG","CCCR","CCE","CCG","CCI","CCL","CCLP","CCN","CCO","CCRN","CCUR","CDI","CDK","CDNS","CDTI","CDW","CDZI","CE","CEB","CECE","CECO","CELG","CELP","CEMI","CENT","CERE","CERN","CERU","CF","CFFI","CFNB","CFNL","CFR","CFRX","CFX","CGA","CHCI","CHCO","CHD","CHE","CHEF","CHGG","CHH","CHK","CHMG","CHMI","CHMT","CHRS","CHRW","CHS","CHTR","CI","CIDM","CIE","CIEN","CIM","CINF","CINR","CIT","CIVI","CIX","CJJD","CKEC","CKH","CL","CLC","CLDT","CLF","CLGX","CLH","CLI","CLNE","CLR","CLX","CMA","CMC","CMCSA","CME","CMG","CMI","CMN","CMO","CMP","CMPR","CMRX","CMS","CMT","CMTL","CNA","CNAT","CNCE","CNK","CNL","CNP","CNTY","CNX","CNXN","COB","COBZ","COF","COG","COH","COHU","COKE","COL","COLB","CONE","COO","COP","COR","CORE","CORI","CORT","COST","COTY","CPAH","CPB","CPE","CPHI","CPK","CPN","CPRT","CPT","CQH","CR","CRBP","CRCM","CREE","CRI","CRIS","CRL","CRM","CRMD","CRMT","CRR","CRS","CRTN","CSC","CSCD","CSCO","CSGS","CSII","CSL","CSPI","CST","CSX","CTAS","CTB","CTBI","CTCT","CTIC","CTL","CTLT","CTO","CTRE","CTRN","CTRV","CTSH","CTXS","CUB","CUBI","CUDA","CUI","CUTR","CVA","CVBF","CVC","CVG","CVGI","CVI","CVLT","CVO","CVRS","CVS","CVV","CVX","CWT","CXDC","CXO","CXP","CXW","CY","CYBE","CYCC","CYH","CYTK","CYTX","CZNC","D","DAIO","DAL","DAN","DATA","DAVE","DBD","DCI","DCO","DD","DDD","DDR","DDS","DE","DECK","DEI","DEL","DENN","DF","DFS","DFT","DG","DGX","DHI","DHIL","DHR","DIS","DISCA","DISH","DKL","DKS","DLA","DLB","DLPH","DLR","DLTR","DLX","DMLP","DMND","DMRC","DNB","DNKN","DNR","DO","DORM","DOV","DOW","DPRX","DPS","DPZ","DRAM","DRE","DRI","DRII","DRQ","DSCI","DSPG","DSS","DST","DSW","DTE","DTLK","DTRM","DUK","DV","DVA","DVD","DVN","DWA","DXYN","DYNT","EA","EAC","EAT","EBAY","EBIO","EBTC","ECL","ECR","ECYT","ED","EEFT","EEP","EFII","EFX","EGAS","EGBN","EGLE","EGLT","EGN","EGP","EIG","EIX","EL","ELGX","ELS","EMC","EME","EMES","EMG","EMKR","EMN","EMR","ENH","ENPH","ENSG","EOG","EPC","EPE","EPRS","EQC","EQIX","EQM","EQR","EQT","EQY","ERB","ERIE","ERII","ES","ESE","ESL","ESMC","ESRX","ESS","ESV","ESXB","ETE","ETFC","ETH","ETN","ETR","ETSY","EV","EVC","EVDY","EVEP","EVER","EVI","EVOK","EW","EWBC","EXA","EXAC","EXAR","EXAS","EXC","EXLS","EXP","EXPD","EXPE","EXPR","EXR","F","FAC","FAF","FANG","FARM","FAST","FATE","FB","FBC","FBHS","FBIO","FBIZ","FBNC","FBP","FBRC","FCB","FCEA","FCF","FCFS","FCN","FCNCA","FCS","FCSC","FCTY","FCX","FDS","FDX","FE","FELE","FES","FEYE","FF","FFIC","FFIN","FFIV","FGEN","FH","FHCO","FHN","FICO","FII","FINL","FIS","FISI","FISV","FIT","FITB","FIVE","FIVN","FIX","FL","FLDM","FLIR","FLL","FLO","FLR","FLS","FLT","FLWS","FLXN","FLXS","FMC","FMD","FMER","FMNB","FNF","FNFG","FNGN","FNSR","FOR","FORM","FOSL","FOX","FPI","FR","FRGI","FRME","FRP","FRPH","FRT","FSBK","FSBW","FSFG","FSI","FSLR","FSS","FSTR","FTEK","FTI","FTNT","FTR","FULL","FULT","FUSB","FVE","FXCM","G","GALT","GAS","GATX","GBCI","GBIM","GBL","GBR","GBSN","GBX","GCI","GCO","GD","GDOT","GE","GEF","GEO","GERN","GES","GFED","GFF","GFIG","GGG","GGP","GHC","GHL","GIFI","GILD","GIMO","GIS","GLOW","GLRI","GLW","GM","GMAN","GMCR","GME","GNBC","GNC","GNE","GNMK","GNOW","GNTX","GNVC","GNW","GOOGL","GORO","GOV","GPC","GPN","GPOR","GPS","GPX","GRA","GRC","GRMN","GRPN","GRUB","GS","GSM1","GST","GSVC","GT","GTIM","GTLS","GTN","GTWN","GTXI","GVA","GWR","GWRE","GWW","GXP","H","HA","HAE","HAL","HALL","HAR","HAS","HBAN","HBCP","HBHC","HBI","HBIO","HBK","HBNC","HCA","HCHC","HCKT","HCN","HCP","HD","HDS","HE","HES","HF","HFC","HGG","HHC","HIG","HII","HIIQ","HIL","HIW","HK","HLF","HLIT","HLX","HMN","HMNF","HMSY","HNI","HNR","HNT","HOG","HOLX","HON","HOT","HOV","HP","HPJ","HPQ","HPT","HR","HRB","HRC","HRL","HRS","HSC","HSIC","HSNI","HSON","HST","HSY","HTA","HTBK","HTCH","HTLD","HTS","HUBB","HUM","HUN","HWAY","HWCC","HXL","IAC","IART","IBKC","IBKR","IBM","IBOC","IBP","ICAD","ICCC","ICE","ICFI","ICON","ICPT","IDA","IDCC","IDSA","IDSY","IDTI","IDXG","IDXX","IEX","IFF","IHS","IHT","IIVI","IL","ILMN","IM","IMI","IMN","IMO","IMUC","INAP","INCY","INGN","INGR","INO","INOD","INS","INSG","INSM","INSY","INT","INTC","INTU","INTX","INVA","IONS","IOSP","IP","IPAR","IPDN","IPG","IPGP","IPHI","IPI","IPXL","IQNT","IR","IRC","IRET","IRG","IRIX","IRM","IRT","IRWD","ISCA","ISIL","ISLE","ISR","ISRG","ISRL","ISSC","IT","ITC","ITCI","ITRI","ITT","ITW","IVAC","IVZ","JAH","JAKK","JBHT","JBL","JBLU","JBT","JCI","JCP","JCS","JCTCF","JEC","JJSF","JKHY","JLL","JMP","JNJ","JNPR","JNS","JOY","JPEP","JPM","JVA","JWA","JWN","JXSB","K","KAMN","KAR","KATE","KBH","KBR","KCAP","KE","KEGX","KEX","KEY","KFFB","KFRC","KFY","KGJI","KIM","KIRK","KITE","KLAC","KMB","KMG","KMI","KMPR","KMT","KMX","KND","KNL","KNX","KO","KODK","KOOL","KOP","KORS","KOS","KR","KRC","KRG","KRO","KS","KSS","KSU","KVHI","L","LAD","LAKE","LAMR","LANC","LAND","LARK","LAYN","LAZ","LB","LBIO","LBRDA","LBTYA","LCI","LCNB","LCUT","LDOS","LEA","LECO","LEG","LEN","LEU","LF","LFVN","LGCY","LGF","LH","LHCG","LHO","LII","LINC","LION","LIVE","LJPC","LKQ","LL","LLEX","LLL","LLTC","LLY","LM","LMCA","LMIA","LMNR","LMT","LNC","LNCE","LNDC","LNG","LNKD","LNT","LOCK","LOPE","LOV","LOW","LPI","LPLA","LPNT","LPSB","LPT","LPX","LRCX","LSCC","LSTR","LUK","LUV","LVLT","LVS","LXK","LXP","LXRX","LXU","LYB","LZB","M","MA","MAA","MAC","MACK","MAN","MANT","MAR","MARA","MAS","MASI","MAT","MATN","MATR","MATW","MATX","MBFI","MBI","MBRG","MBTF","MC","MCBC","MCD","MCF","MCHP","MCK","MCO","MCY","MD","MDC","MDGL","MDLY","MDLZ","MDP","MDR","MDRX","MDT","MDU","MDVN","MEIP","MEMP","MENT","MESG","MET","MFA","MFRM","MG","MGEE","MGM","MHGC","MHK","MHLD","MIC","MICT","MITK","MITT","MJN","MKC","MKL","MKTX","MLHR","MLI","MLM","MLVF","MMC","MMM","MNGA","MNK","MNKD","MNRO","MNST","MO","MOBL","MODN","MOFG","MOGA","MOH","MON","MORN","MOS","MPAA","MPB","MPC","MPOYQ","MPX","MRC","MRD","MRK","MRLN","MRNS","MRO","MRVL","MS","MSA","MSCI","MSFG","MSFT","MSGN","MSI","MSL","MSM","MSON","MSTR","MSTX","MTB","MTD","MTDR","MTOR","MTSI","MTW","MTX","MTZ","MU","MUR","MUSA","MWW","MXIM","MYE","MYGN","MYL","MYOS","N","NANO","NATI","NAUH","NAV","NAVI","NBHC","NBL","NBN","NBR","NBY","NCI","NCIT","NCLH","NCR","NCS","NDAQ","NDLS","NDSN","NE","NEE","NEM","NEO","NEP","NEU","NEWM","NFBK","NFG","NFLX","NFX","NGHC","NGL","NGLS","NI","NKA","NKE","NLSN","NLST","NLY","NMBL","NNI","NNN","NOC","NOG","NOV","NOW","NP","NPO","NRG","NSC","NSH","NSM","NSR","NSTG","NTAP","NTGR","NTRI","NTRS","NUAN","NUE","NUS","NUTR","NVDA","NVET","NVFY","NVR","NWE","NWFL","NWL","NWSA","NXTM","NYCB","NYNY","NYRT","NYT","O","OA","OAS","OB","OBCI","OC","OCC","OCN","OCRX","ODC","ODFL","ODP","OESX","OFC","OGE","OGEN","OGS","OHAI","OHGI","OHI","OI","OII","OIS","OKE","OKS","OKSB","OLED","OLN","OMC","OMCL","OME","OMER","OMEX","OMI","ON","ONP","OPXA","OPY","ORA","ORBC","ORC","ORCL","ORI","ORLY","OSBC","OSK","OSTK","OTTR","OUT","OXBR","OXFD","OXY","OZRK","P","PAHC","PANW","PAR","PARR","PAY","PAYC","PAYX","PB","PBCT","PBF","PBFX","PBH","PBI","PBPB","PBSK","PBY","PBYI","PCAR","PCBK","PCG","PCH","PCL","PCLN","PCMI","PCP","PDCE","PDCO","PDM","PEB","PEBK","PEG","PEGA","PENN","PEP","PERY","PETX","PF","PFE","PFG","PFIS","PFMT","PFS","PFSW","PG","PGC","PGLC","PGR","PH","PHM","PICO","PIH","PII","PKBK","PKG","PKI","PLCM","PLD","PLKI","PLT","PM","PMBC","PMD","PMT","PNC","PNM","PNNT","PNR","PNRA","PNW","PNY","POM","POOL","POST","POT","POWL","POWR","PPBI","PPC","PPG","PPHM","PPL","PPS","PRA","PRCP","PRE","PRGO","PRI","PRIM","PRO","PROV","PRSS","PRTA","PRU","PSA","PSMT","PSTR","PSX","PTEN","PTIE","PTLA","PTN","PVH","PW","PWR","PX","PXD","PYPL","PZN","Q","QBAK","QCCO","QCOM","QEP","QLTI","QRHC","QRVO","QTM","QUAD","QVCA","R","RAD","RAI","RAND","RAVE","RAVN","RAX","RBC","RBPAA","RCII","RCKY","RCL","RCMT","RDC","RDI","RE","REG","REGN","RELY","REPH","RES","REV","REX","RF","RFP","RGA","RGC","RGLD","RGR","RGS","RHI","RHP","RHT","RICE","RIG","RJF","RL","RLGY","RLI","RLOG","RMD","RMTI","RNET","RNF","RNR","RNWK","ROK","ROL","ROP","ROST","ROVI","ROX","ROYL","RPAI","RPM","RPRX","RRC","RRD","RS","RSE","RSG","RSO","RSPP","RST","RTK","RTN","RTRX","RUTH","RVLT","RVSB","RXN","RYN","SAFM","SAFT","SAGE","SAIC","SAMG","SATS","SAUC","SBAC","SBCF","SBH","SBUX","SBY","SC","SCCO","SCG","SCHL","SCHW","SCI","SCMP","SCNB","SCTY","SDOC","SE","SEAS","SEE","SEIC","SFG","SFM","SFNC","SFST","SFXE","SGEN","SGI","SGMA","SGMS","SHAK","SHBI","SHLD","SHO","SHOS","SHW","SIG","SINO","SIRI","SIRO","SIVB","SIX","SJM","SKT","SKY","SKYW","SLAB","SLB","SLCA","SLD","SLG","SLGN","SLH","SLM","SLRC","SM","SMBC","SMG","SMLP","SMTC","SN","SNA","SNDK","SNH","SNI","SNPS","SNR","SNSS","SNV","SO","SOCB","SON","SONA","SONS","SPG","SPGI","SPH","SPKE","SPLK","SPLP","SPLS","SPN","SPNC","SPPI","SPR","SPRT","SPTN","SPWH","SPWR","SPXC","SQI","SRC","SRCL","SRE","SREV","SRT","SSKN","SSNC","SSP","SSY","ST","STAA","STAY","STC","STFC","STI","STJ","STL","STLD","STLY","STML","STMP","STR","STRI","STRS","STRT","STRZA","STT","STWD","STX","STZ","SUMR","SUN","SUNE","SVU","SWI","SWK","SWKS","SWN","SWSH","SXI","SXT","SYA","SYF","SYK","SYKE","SYMC","SYNA","SYNC","SYNL","SYPR","SYRG","SYY","T","TA","TAL","TAP","TAYD","TBI","TBK","TBPH","TCAP","TCB","TCFC","TCO","TCS","TDC","TDG","TDS","TDW","TE","TEAR","TECH","TEL","TEP","TER","TERP","TEX","TFM","TFSL","TFX","TGI","TGLS","TGNA","TGT","TGTX","THC","THG","THO","THS","TIF","TIK","TILE","TINY","TIS","TITN","TIVO1","TJX","TKAI","TKR","TLP","TMHC","TMK","TMO","TMQ","TMUS","TNAV","TNC","TNGO","TNH","TNXP","TOF","TOL","TOR","TORM","TOWR","TPL","TPX","TR","TRCB","TREX","TRGP","TRIP","TRMB","TRMK","TRN","TRNS","TRNX","TROW","TROX","TRS","TRV","TSCO","TSLA","TSN","TSO","TSQ","TSRI","TSS","TST","TTC","TTEK","TTMI","TTS","TUES","TUMI","TUP","TVIA","TVPT","TWC","TWI","TWO","TWX","TXN","TXRH","TXT","TXTR","TYC","TYL","UA","UAL","UAMY","UAN","UBA","UBNK","UBSH","UBSI","UCBI","UCP","UDR","UFI","UFS","UG","UGA","UGI","UHAL","UHS","UHT","UIHC","UIS","ULBI","ULTA","UNB","UNFI","UNH","UNM","UNP","UNT","UNXL","UPL","UPS","URBN","URI","URRE","USAC","USB","USL","USM","USNA","USO","UTEK","UTHR","UTMD","UTX","UUU","UVE","UVV","UWN","V","VAL","VALU","VAR","VC","VCEL","VDSI","VEC","VEEV","VER","VFC","VHC","VIAB","VIAV","VICR","VII","VIRC","VIVO","VLO","VLTC","VLY","VMC","VMI","VMW","VNCE","VNO","VNR","VNTV","VOXX","VOYA","VR","VRNT","VRSK","VRSN","VRTS","VRTX","VSAR","VSCP","VSH","VSTM","VTL","VTNR","VTR","VVC","VVI","VZ","W","WAB","WABC","WAFD","WAGE","WAT","WAYN","WBA","WBC","WBKC","WBMD","WBS","WCC","WCG","WCN","WCST","WD","WDAY","WDC","WDFC","WDR","WEC","WEN","WERN","WEX","WFC","WFM","WFT","WGL","WHR","WIFI","WIN","WINA","WINT","WLB","WLK","WLKP","WLL","WM","WMB","WMC","WMLP","WMT","WNC","WNR","WOOF","WOR","WPC","WPG","WPX","WPZ","WR","WRB","WRI","WRK","WSBC","WSCI","WSM","WSO","WST","WSTL","WTBA","WTI","WTM","WTR","WTS","WU","WWAV","WWD","WWE","WWW","WY","WYN","WYNN","WYY","X","XBKS","XBKS1","XCRA","XEC","XEL","XENT","XL","XLNX","XOM","XON","XPL","XPLR","XPO","XRAY","XRX","XXII","XYL","Y","YDKN","YHOO","YRCW","YUM","Z","ZAYO","ZBH","ZBRA","ZEN","ZFGN","ZGNX","ZINCQ","ZION","ZLTQ","ZNGA","ZTS","ZUMZ"]
indicatorList = [   'REVENUE','REVENUEUSD','COR','GP','RND','SGNA','EBIT','EBITUSD','INTEXP','EBT','TAXEXP','NETINC','PREFDIVIS',   \
                    'NETINCCMN','NETINCCMNUSD','NETINCDIS','EPS','EPSUSD','EPSDIL','SHARESWA','SHARESWADIL','DPS','NCFO','DEPAMOR', \
                    'NCFI','CAPEX','NCFF','NCFDEBT','NCFCOMMON','NCFDIV','NCFX','NCF','ASSETS','ASSETSC','ASSETSNC','CASHNEQ',      \
                    'CASHNEQUSD','RECEIVABLES','INTANGIBLES','INVENTORY','LIABILITIES','LIABILITIESC','LIABILITIESNC','DEBT',       \
                    'DEBTUSD','PAYABLES','EQUITY','EQUITYUSD','RETEARN','ACCOCI','BVPS','CURRENTRATIO','DE','DILUTIONRATIO',        \
                    'EBITDA','EBITDAUSD','FCF','FCFPS','INVCAP','TANGIBLES','TBVPS','WORKINGCAPITAL']

quandl.ApiConfig.api_key='zcxKTeTbMQ5nPdeoPQoR'

#dict = {}

for symbol in symbolList:
    #content = {}
    #dict[symbol]=content
    #print("[SYMBOL] "+symbol);
    
    # list of df
    df = pd.DataFrame()
    for indicator in indicatorList:
        # print("[INDICT] "+indicator);
        
        queryString = feedType+"/"+symbol+"_"+indicator+"_MRY";
        data = quandl.get(queryString);
        # content[indicator]=data
        # data.set_index(indicator)
        data.columns=[indicator]
        
        # print(data)
        frames = [df,data]
        df=pd.concat(frames, axis=1)
        
        
    #print(df)
    fileName="C:\\Users\\William\\Desktop\\alphaB\\generated\\"+feedType+"_"+symbol+".csv"
    df.to_csv(fileName, sep='|')
    nowtime = strftime("%H:%M:%S", gmtime())
    print("["+nowtime+"] Written to file: "+fileName)
        
# print(dict['MOGA']['REVENUEUSD'])